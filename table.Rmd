---
title: "table"
author: "TJ Tang"
date: "4/24/2022"
output: html_document
---

```{r setup, include=FALSE}
library(flextable)
source("table_helper.R")
knitr::opts_chunk$set(echo = TRUE)
```


For the Table 1, the number of covariates is 5, the sample size is 50, the variance for the error term is 0.01, coefficients for covariates follow normal distribution, and the outcome model is generated from linear functions. 

```{r}
idx1 = c(1,2,65,66)
table1 = make_table(idx)
table1 %>% flextable() %>% autofit() %>% font(fontname = "Cambria",part = "all") %>%
  set_caption("Table1",style = "Table Caption")
```

For the Table 2, the number of covariates is 100, the sample size is 50, the variance for the error term is 0.01, coefficients for covariates follow normal distribution, and the outcome model is generated from linear functions. This is the case where the number of covariates is relatively higher than the sample size.

```{r}
idx2 = c(3,4,67,68)
table2 = make_table(idx2)
table2 %>% flextable() %>% autofit() %>% font(fontname = "Cambria",part = "all") %>%
  set_caption("Table2",style = "Table Caption")
```


We explored 128 different scenarios in the data generation process with following configurations.  
- Number of covariates: 5 or 100  
- Sample size $N$: 50 or 1000  
- Number of folds $K$: 2  
- Variance of the error term $U$ and $V$: 0.1
- Distribution of coefficients for covariates $g_0$: $N\sim(1,0.5^2)$ or $U\sim(0.5,1.5)$  
- Outcome model: linear or non-linear with sine functions

```{r}
idx = c(1,3,5,7,65,67,69,71)
```


```{r}
make_table2 <- function(idx){
  
  r1 = c(stats_simdata(idx[1])[1],stats_simdata(idx[1])[3],
         stats_simdata(idx[1])[2],stats_simdata(idx[1])[4],
         stats_simdata(idx[2])[1],stats_simdata(idx[2])[3],
         stats_simdata(idx[2])[2],stats_simdata(idx[2])[4])
  r2 = c(stats_simdata(idx[3])[1],stats_simdata(idx[3])[3],
         stats_simdata(idx[3])[2],stats_simdata(idx[3])[4],
         stats_simdata(idx[4])[1],stats_simdata(idx[4])[3],
         stats_simdata(idx[4])[2],stats_simdata(idx[4])[4])
  df = rbind("XGBoost"=r1,"LASSO"=r2) %>% as.data.frame()
  colnames(df) <- c("fllm","fllse","llm","llse",
                    "flhm","flhse","lhm","lhse")
  df = round_df(df,3)
  df <- df %>%
    mutate(fll=paste0(fllm,"(",fllse,")")) %>%
    mutate(flh=paste0(flhm,"(",flhse,")")) %>%
    mutate(ll=paste0(llm,"(",llse,")")) %>%
    mutate(lh=paste0(lhm,"(",lhse,")")) %>%
    dplyr::select(fll,ll,flh,lh) %>%
    rownames_to_column(" ")
  return(df)
}
```


```{r}
idx3 <- c(1,3,65,67)
table3 = make_table2(idx3)
table3 %>% flextable() %>% font(fontname = "Cambria",part = "all") %>%
  set_header_labels(method="Method",fll="Full",ll="Twofold",flh="Full",lh="Twofold") %>%
  add_header_row(top = TRUE, values = c("","N=50, Ncov=5", "N=50, Ncov=100"), 
                 colwidths = c(1,2,2)) %>% autofit() %>%
  set_caption("Table3",style = "Table Caption") 
```

```{r}
idx4 <- c(5,7,69,71)
table4 = make_table2(idx4)
table4 %>% flextable() %>% font(fontname = "Cambria",part = "all") %>%
  set_header_labels(method="Method",fll="Full",ll="Twofold",flh="Full",lh="Twofold") %>%
  add_header_row(top = TRUE, values = c("","N=1000, Ncov=5","N=1000, Ncov=100"), 
                 colwidths = c(1,2,2)) %>% autofit() %>%
  set_caption("Table4",style = "Table Caption") 
```






